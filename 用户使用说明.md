# Outlook 邮件翻译插件 - 用户使用说明

## 快速开始（3 步）

### 方式一：使用 EXE 文件（最简单）

1. **双击运行** `Outlook翻译插件.exe`
2. **加载插件** 在 Outlook 中加载 `manifest.xml`
3. **开始使用** 打开邮件，点击 "翻译邮件" 按钮

### 方式二：使用 BAT 文件

1. **双击运行** `启动服务器.bat`
2. **加载插件** 在 Outlook 中加载 `manifest.xml`
3. **开始使用** 打开邮件，点击 "翻译邮件" 按钮

---

## 详细步骤

### 第一步：启动服务器

**Windows 用户：**

选择以下任意一种方式：

#### A. EXE 文件（推荐）
- 双击 `Outlook翻译插件.exe`
- 服务器自动在后台启动
- 会显示一个命令行窗口，不要关闭

#### B. BAT 文件
- 双击 `启动服务器.bat`
- 自动检查并安装依赖
- 启动服务器

**看到以下信息说明启动成功：**

```
========================================
  Outlook 邮件翻译插件服务器
========================================

  服务器地址: http://localhost:3000
  按 Ctrl+C 停止服务器

========================================
```

**保持此窗口打开**，最小化即可

### 第二步：在 Outlook 中加载插件

#### Outlook 网页版

1. 访问 https://outlook.office.com
2. 点击右上角 **设置**（齿轮图标）
3. 选择 **"管理加载项"** 或 **"Get Add-ins"**
4. 点击 **"自定义加载项"**
5. 选择 **"从文件添加"**
6. 上传 `manifest.xml` 文件
7. 点击确认

#### Outlook 桌面版

1. 打开 Outlook
2. 点击 **"文件"** → **"管理加载项"**
3. 选择 **"自定义加载项"**
4. 点击 **"从文件添加"**
5. 上传 `manifest.xml` 文件
6. 重启 Outlook

### 第三步：配置并使用

1. **打开任意邮件**
2. 点击工具栏中的 **"翻译邮件"** 按钮
3. 首次使用时：
   - 点击右上角 **"⚙️ 设置"** 按钮
   - 输入您的 API Token
   - 点击 **"保存设置"**
4. 点击 **"翻译为中文"** 按钮
5. 等待翻译完成

---

## 配置 API Token

### 如何获取 API Token？

请联系您的管理员或 API 提供商获取：
- API 地址
- 认证 Token（Bearer Token）

### 配置步骤

1. 打开插件，点击右上角 **"⚙️ 设置"** 按钮
2. 填写以下信息：
   - **API 地址**：如 `https://portal.insuremo.com/api/...`
   - **认证 Token**：如 `Bearer your-token-here`
     - 如果您的 Token 没有 "Bearer " 前缀，会自动添加
   - **LLM 模型**：选择 AI 模型（如 qwen-max）
   - **Temperature**：0-1 之间的数字，推荐 0.2
3. 点击 **"保存设置"**

配置会保存在您的浏览器中，不需要每次都输入。

---

## 常见问题

### Q1：服务器启动失败

**可能原因：**
- 端口 3000 被占用
- 缺少 Node.js（EXE 版本不需要）

**解决方法：**
1. 关闭其他占用 3000 端口的程序
2. 运行 `检查状态.bat` 查看详细错误信息

### Q2：插件无法加载

**解决方法：**
1. 确认服务器正在运行
2. 在浏览器中访问 http://localhost:3000 测试
3. 重新加载 manifest.xml

### Q3：翻译失败

**可能原因：**
- API Token 无效或过期
- 网络连接问题
- API 地址错误

**解决方法：**
1. 点击 "设置" 按钮，检查 API 配置
2. 按 F12 打开浏览器控制台，查看错误信息
3. 联系管理员确认 Token 是否有效

### Q4：如何停止服务器？

- EXE 版本：直接关闭窗口或按 Ctrl+C
- BAT 版本：按 Ctrl+C 或运行 `停止服务器.bat`

### Q5：是否每次开机都要启动？

是的，需要在使用前启动服务器。

**自动启动方案：**
1. 将 `启动服务器.bat` 或 `Outlook翻译插件.exe` 的快捷方式放到启动文件夹
2. 启动文件夹位置：`shell:startup`（在运行中输入）

---

## 系统要求

- Windows 7 或更高版本
- Outlook 2016 或更高版本（桌面版或网页版）
- 网络连接

**注意：** 使用 EXE 版本无需安装 Node.js

---

## 文件说明

```
translate2/
├── Outlook翻译插件.exe    # 独立服务器（推荐）
├── 启动服务器.bat          # 启动脚本
├── 停止服务器.bat          # 停止脚本
├── 一键安装.bat            # 首次安装
├── 检查状态.bat            # 状态检查
├── manifest.xml            # 插件清单（必须）
├── taskpane.html           # 界面文件（必须）
├── taskpane.css            # 样式文件（必须）
├── taskpane.js             # 脚本文件（必须）
├── settings.html           # 设置页面（必须）
├── settings.js             # 设置脚本（必须）
└── 用户使用说明.md         # 本文档
```

**标注 "必须" 的文件是插件运行必需的，请确保都在同一目录下**

---

## 更新和卸载

### 更新插件

如果收到新版本：
1. 停止服务器
2. 替换所有文件（除了配置相关）
3. 重新启动服务器
4. 在 Outlook 中重新加载 manifest.xml

### 卸载插件

1. 停止服务器
2. 在 Outlook 中删除加载项
3. 删除所有文件

---

## 技术支持

如遇到问题：
1. 运行 `检查状态.bat` 诊断问题
2. 查看浏览器控制台（F12）的错误信息
3. 联系技术支持

---

## 安全提示

- 不要将您的 API Token 分享给他人
- 定期更换 API Token
- 不要在不安全的网络环境下使用

---

**祝您使用愉快！**
