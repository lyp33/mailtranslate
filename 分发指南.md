# Outlook 翻译插件 - 分发指南

## 给其他用户使用时，需要提供哪些文件？

### 方案一：EXE 版本（最简单，推荐）

**需要分发的文件：**

```
分发文件/
├── Outlook翻译插件.exe      # 主程序
├── manifest.xml              # 插件清单
├── taskpane.html             # 必需的前端文件
├── taskpane.css
├── taskpane.js
├── settings.html
├── settings.js
├── functions.html
├── 用户使用说明.md           # 使用文档
└── 分发说明.txt              # 简单说明
```

**用户只需：**
1. 双击 `Outlook翻译插件.exe` 启动服务器
2. 在 Outlook 中加载 `manifest.xml`
3. 开始使用

**优点：**
- 无需安装 Node.js
- 双击即用
- 用户体验最好

---

### 方案二：BAT 版本

**需要分发的文件：**

```
分发文件/
├── 启动服务器.bat            # 启动脚本
├── 一键安装.bat              # 首次安装
├── 检查状态.bat              # 状态检查
├── 停止服务器.bat            # 停止脚本
├── manifest.xml
├── taskpane.html
├── taskpane.css
├── taskpane.js
├── settings.html
├── settings.js
├── functions.html
├── package.json
├── server.js
├── 用户使用说明.md
└── 分发说明.txt
```

**用户需要：**
1. 先安装 Node.js
2. 双击 `一键安装.bat`
3. 双击 `启动服务器.bat`
4. 在 Outlook 中加载 `manifest.xml`

---

## 快速分发步骤

### 步骤 1：准备分发包

#### A. 如果使用 EXE 版本

1. 运行 `打包成EXE.bat`
2. 创建一个文件夹，如 `Outlook翻译插件-v1.0`
3. 复制以下文件到该文件夹：
   ```
   ✓ Outlook翻译插件.exe
   ✓ manifest.xml
   ✓ taskpane.html
   ✓ taskpane.css
   ✓ taskpane.js
   ✓ settings.html
   ✓ settings.js
   ✓ functions.html
   ✓ 用户使用说明.md
   ✓ 分发说明.txt（见下方）
   ```
4. 压缩为 ZIP 文件

#### B. 如果使用 BAT 版本

1. 创建一个文件夹，如 `Outlook翻译插件-v1.0`
2. 复制所有项目文件（除了 node_modules）
3. 压缩为 ZIP 文件

---

### 步骤 2：创建分发说明文件

创建 `分发说明.txt`：

```
========================================
  Outlook 邮件翻译插件
========================================

【安装说明】

方式一：EXE 版本（推荐）
1. 解压所有文件到任意文件夹
2. 双击 "Outlook翻译插件.exe" 启动服务器
3. 在 Outlook 中加载 manifest.xml 文件
4. 开始使用

方式二：BAT 版本
1. 先安装 Node.js: https://nodejs.org/
2. 双击 "一键安装.bat"
3. 双击 "启动服务器.bat"
4. 在 Outlook 中加载 manifest.xml 文件
5. 开始使用

【首次使用】
1. 打开 Outlook，打开任意邮件
2. 点击工具栏的 "翻译邮件" 按钮
3. 点击右上角 "设置" 按钮
4. 输入您的 API Token 并保存
5. 点击 "翻译为中文"

【详细说明】
请查看 "用户使用说明.md"

【系统要求】
- Windows 7 或更高版本
- Outlook 2016 或更高版本
- 网络连接

【技术支持】
遇到问题请查看 "用户使用说明.md" 的常见问题部分

========================================
```

---

### 步骤 3：分发方式

#### 内部分发

1. **企业网盘 / 共享文件夹**
   - 上传 ZIP 文件
   - 发送下载链接给员工

2. **邮件**
   - 将 ZIP 文件作为附件发送
   - 注意：如果文件过大，使用网盘

3. **即时通讯工具**
   - 通过企业微信、钉钉等发送

#### 公开发布

1. **GitHub Releases**
   - 创建 GitHub 仓库
   - 发布 Release，附上 ZIP 文件

2. **内部应用商店**
   - 上传到企业应用商店

---

## 用户安装引导（推荐流程）

### 发送给用户的安装指南

---

**标题：** Outlook 邮件翻译插件 - 安装指南

**步骤 1：下载和准备**

1. 下载插件压缩包
2. 解压到任意文件夹（如 `C:\OutlookTranslator\`）
3. 确保所有文件在同一目录下

**步骤 2：启动服务器**

EXE 版本用户：
```
双击 "Outlook翻译插件.exe"
会弹出一个命令行窗口，不要关闭
```

BAT 版本用户：
```
1. 先安装 Node.js: https://nodejs.org/
2. 双击 "一键安装.bat"
3. 双击 "启动服务器.bat"
```

看到 "服务器地址: http://localhost:3000" 说明启动成功

**步骤 3：在 Outlook 中加载插件**

Outlook 网页版：
1. 访问 https://outlook.office.com
2. 设置（右上角齿轮）→ 管理加载项
3. 自定义加载项 → 从文件添加
4. 上传 manifest.xml

Outlook 桌面版：
1. 文件 → 管理加载项
2. 自定义加载项 → 从文件添加
3. 上传 manifest.xml

**步骤 4：配置 API Token**

1. 打开任意邮件
2. 点击 "翻译邮件" 按钮
3. 点击右上角 "⚙️ 设置" 按钮
4. 输入您的 API Token
5. 点击 "保存设置"

**完成！** 现在可以翻译邮件了

---

## 管理多用户的 API Token

### 方案 A：用户自行管理（推荐）

每个用户使用自己的 API Token：
- 更安全
- 便于计费和权限管理
- Token 保存在用户本地

**操作：**
1. 为每个用户生成独立的 API Token
2. 将 Token 通过安全渠道发送给用户
3. 用户在插件设置中输入自己的 Token

### 方案 B：统一 Token（不推荐）

所有用户共享同一个 Token：
- 需要修改代码，将默认 Token 设置为统一的 Token
- 安全风险较高
- 无法区分使用情况

---

## 更新管理

### 发布新版本时

1. 修改版本号（manifest.xml 中的 `<Version>`）
2. 测试新版本功能
3. 准备新的分发包
4. 通知用户更新

**用户更新步骤：**
1. 停止服务器（关闭窗口或按 Ctrl+C）
2. 替换所有文件
3. 重新启动服务器
4. 在 Outlook 中重新加载 manifest.xml

---

## 批量部署（企业环境）

### 使用组策略（GPO）

1. 将插件文件复制到网络共享位置
2. 创建批处理脚本，自动启动服务器
3. 通过 GPO 部署启动脚本
4. 自动加载 manifest.xml

### 使用 PowerShell 部署脚本

```powershell
# 复制文件到用户电脑
Copy-Item "\\server\share\OutlookTranslator\" "C:\Program Files\OutlookTranslator\" -Recurse -Force

# 创建桌面快捷方式
$WshShell = New-Object -ComObject WScript.Shell
$Shortcut = $WshShell.CreateShortcut("$env:USERPROFILE\Desktop\Outlook翻译插件.lnk")
$Shortcut.TargetPath = "C:\Program Files\OutlookTranslator\Outlook翻译插件.exe"
$Shortcut.WorkingDirectory = "C:\Program Files\OutlookTranslator\"
$Shortcut.Save()

# 自动启动（可选）
Copy-Item "C:\Program Files\OutlookTranslator\Outlook翻译插件.exe" "$env:APPDATA\Microsoft\Windows\Start Menu\Programs\Startup\"
```

---

## 监控和维护

### 收集使用反馈

建议收集：
- 用户数量
- 翻译请求量（通过 API 监控）
- 常见问题和错误

### 定期更新

- 每季度检查 API Token 安全性
- 根据用户反馈优化功能
- 更新依赖库

---

## 常见分发问题

### Q1：用户无法启动服务器

**解决：**
- EXE 版本：检查是否被杀毒软件拦截，添加白名单
- BAT 版本：确保已安装 Node.js

### Q2：某些电脑无法加载插件

**检查：**
- Outlook 版本是否过旧（需要 2016+）
- 是否有足够的权限
- 浏览器是否支持（IE 11+）

### Q3：分发文件过大

**解决：**
- 只分发必需文件
- 使用 7z 格式压缩（比 ZIP 更小）
- 分发时排除 node_modules（用户本地安装）

---

## 建议的分发清单

**最小分发包（EXE 版本）：**
- Outlook翻译插件.exe
- manifest.xml
- 所有 .html、.css、.js 文件
- 用户使用说明.md
- 分发说明.txt

**完整分发包（BAT 版本）：**
- 所有 .bat 文件
- manifest.xml
- 所有源文件
- package.json
- server.js
- 用户使用说明.md
- 分发说明.txt

---

**推荐：优先使用 EXE 版本分发，用户体验最好！**
